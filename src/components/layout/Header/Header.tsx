'use client'

import React, { useEffect, useRef } from 'react'
import { Link } from '@/components/ui/Link'
import { Button } from '@/components/ui/Button'
import { animateHeader } from '@/utils/headerAnimations'
import styles from './Header.module.css'
import clsx from 'clsx'

const menuItems = [
  { label: 'Home Page', href: '/' },
  { label: 'About', href: '/about' },
  { label: 'Careers', href: '/careers' },
  { label: 'Pricing', href: '/pricing' },
]

interface HeaderProps {
  onMenuToggle: () => void
  isMenuOpen: boolean
}

/**
 * Глобальный хедер сайта.
 * Содержит логотип, навигацию и кнопки действий.
 * Анимируется при появлении с помощью GSAP.
 */
export const Header: React.FC<HeaderProps> = ({ onMenuToggle, isMenuOpen }) => {
  const headerRef = useRef<HTMLElement>(null)
  const menuBackgroundRef = useRef<HTMLDivElement>(null)

  useEffect(() => {
    if (headerRef.current && menuBackgroundRef.current) {
      animateHeader(headerRef, menuBackgroundRef)
    }
  }, [])

  return (
    <header ref={headerRef} className={styles.header}>
      <div className={styles.container}>
        <div className={styles.logo}>
          <svg
            width="87"
            height="35"
            viewBox="0 0 87 35"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <g clipPath="url(#clip0_2_456)">
              <path
                d="M38.247 8.5344C37.2233 8.00499 36.0598 7.73993 34.758 7.73993H27.2337C27.0727 7.73993 26.9421 7.87033 26.9421 8.03121V26.9681C26.9421 27.129 27.0727 27.2594 27.2337 27.2594H29.7203C29.882 27.2594 30.0126 27.129 30.0126 26.9681V20.3289C30.0126 20.1673 30.1431 20.0369 30.3049 20.0369H34.7587C36.0796 20.0369 37.2474 19.7718 38.2619 19.2424C39.2756 18.713 40.0624 17.983 40.6207 17.0532C41.1791 16.1241 41.4579 15.0829 41.4579 13.9299C41.4579 12.7768 41.1791 11.6988 40.6207 10.7513C40.0624 9.803 39.2714 9.06381 38.2477 8.5344M37.8561 15.6173C37.5581 16.129 37.1395 16.533 36.5997 16.8306C36.0598 17.1283 35.4454 17.2771 34.7573 17.2771H30.3034C30.1424 17.2771 30.0112 17.1467 30.0112 16.9851V10.7924C30.0112 10.6308 30.1417 10.5004 30.3034 10.5004H34.7573C35.4454 10.5004 36.0591 10.645 36.5997 10.9327C37.1388 11.2211 37.5574 11.6258 37.8561 12.146C38.1533 12.6669 38.303 13.2431 38.303 13.8753C38.303 14.5075 38.154 15.107 37.8561 15.618"
                fill="white"
              />
              <path
                d="M49.5749 25.6037L45.6184 13.2132C45.5801 13.0927 45.4672 13.0105 45.3403 13.0105H42.8062C42.6061 13.0105 42.4656 13.2068 42.5295 13.396L47.1607 27.0622C47.2011 27.1806 47.3125 27.26 47.4373 27.26H49.1648C49.3649 27.26 49.5061 27.4563 49.4415 27.6462L47.8055 32.4513C47.741 32.6405 47.8822 32.8376 48.0822 32.8376H50.4517C50.5773 32.8376 50.6887 32.7575 50.7284 32.6391L57.2304 13.396C57.2942 13.2068 57.1538 13.0112 56.9537 13.0112H54.5842C54.4586 13.0112 54.3472 13.0913 54.3075 13.2104L50.1296 25.6094C50.0396 25.8765 49.66 25.8737 49.5742 25.6051"
                fill="white"
              />
              <path
                d="M86.0093 16.3838C85.3488 15.2499 84.4414 14.3583 83.2879 13.707C82.1336 13.0564 80.8496 12.7311 79.4357 12.7311C78.0218 12.7311 76.737 13.0564 75.5834 13.707C74.4292 14.3583 73.5218 15.2506 72.8621 16.3838C72.2016 17.5185 71.871 18.7729 71.871 20.1485C71.871 21.5241 72.2009 22.7743 72.8621 23.899C73.5218 25.0245 74.4292 25.9118 75.5834 26.5624C76.737 27.213 78.021 27.5383 79.4357 27.5383C80.8503 27.5383 82.1336 27.213 83.2879 26.5624C84.4414 25.9118 85.3488 25.0245 86.0093 23.899C86.6698 22.7743 87.0004 21.5248 87.0004 20.1485C87.0004 18.7722 86.6698 17.5178 86.0093 16.3838ZM83.3858 22.5468C82.9857 23.2718 82.4408 23.8395 81.7527 24.2477C81.0638 24.6567 80.2912 24.8615 79.4357 24.8615C78.5801 24.8615 77.8068 24.6574 77.1187 24.2477C76.4305 23.8388 75.8857 23.2718 75.4855 22.5468C75.0854 21.8218 74.8854 21.0224 74.8854 20.1485C74.8854 19.2747 75.0854 18.4752 75.4855 17.7502C75.8857 17.0252 76.4298 16.4582 77.1187 16.0493C77.8068 15.6404 78.5794 15.4363 79.4357 15.4363C80.2919 15.4363 81.0638 15.6411 81.7527 16.0493C82.4408 16.4582 82.985 17.0252 83.3858 17.7502C83.7852 18.4752 83.986 19.2747 83.986 20.1485C83.986 21.0224 83.7859 21.8218 83.3858 22.5468Z"
                fill="white"
              />
              <path
                d="M67.6583 13.0105H70.5464C70.8011 13.0105 70.9338 13.3131 70.7607 13.5002L65.8876 18.7745C65.7897 18.8801 65.784 19.041 65.8734 19.1537L71.927 26.7873C72.0788 26.9786 71.9426 27.26 71.6986 27.26H68.731C68.6416 27.26 68.5572 27.2189 68.5018 27.1494L62.2269 19.2274C62.1382 19.1154 62.1439 18.9566 62.2397 18.8503L67.4419 13.1062C67.4973 13.0452 67.576 13.0105 67.6583 13.0105Z"
                fill="white"
              />
              <path
                d="M61.2064 27.2601H58.8596C58.6985 27.2601 58.568 27.1297 58.568 26.9688V6.91634C58.568 6.75546 58.6985 6.62506 58.8596 6.62506H61.2064C61.3681 6.62506 61.498 6.75546 61.498 6.91634V26.9688C61.498 27.1297 61.3674 27.2601 61.2064 27.2601Z"
                fill="white"
              />
              <path
                d="M2.02189 0.0800931L7.89174 2.03473C8.51888 2.24381 8.9417 2.82992 8.9417 3.49044V31.5096C8.9417 32.1701 8.51888 32.7562 7.89174 32.9653L2.02189 34.9199C1.02726 35.2516 0 34.5117 0 33.4642V1.5358C0 0.488314 1.02655 -0.251586 2.02189 0.0800931Z"
                fill="white"
              />
              <path
                d="M10.1626 11.6435V4.91922C10.1626 3.87174 11.1899 3.13255 12.1845 3.46352L18.0543 5.41745C18.6815 5.62652 19.105 6.21263 19.105 6.87315V11.6428C19.105 12.4904 18.4169 13.1772 17.5691 13.1772H11.6992C10.8507 13.1772 10.1633 12.4897 10.1633 11.6428"
                fill="white"
              />
              <path
                d="M11.6986 14.3973H17.5685C18.417 14.3973 19.1044 15.0848 19.1044 15.9317V20.7028C19.1044 21.3633 18.6809 21.9494 18.0538 22.1585L12.1846 24.1131C11.19 24.4441 10.1627 23.7049 10.1627 22.6574V15.9317C10.1627 15.0841 10.8509 14.3973 11.6986 14.3973Z"
                fill="white"
              />
            </g>
            <defs>
              <clipPath id="clip0_2_456">
                <rect width="87" height="35" fill="white" />
              </clipPath>
            </defs>
          </svg>
        </div>
        <nav className={styles.menu}>
          <div ref={menuBackgroundRef} className={styles.menuBackground}></div>
          {menuItems.map((item) => (
            <Link className={styles.menuLink} key={item.href} href={item.href} variant="secondary">
              {item.label}
            </Link>
          ))}
        </nav>
        <div className={styles.buttons}>
          <Link href="/login" variant="secondary" className={clsx("desktop-only", styles.buttons_item)}>
            Login
          </Link>
          <Button className={clsx("desktop-only", styles.buttons_item)}>Get started</Button>
          <button
            className={`${styles.burger} ${isMenuOpen ? styles.active : ''}`}
            onClick={onMenuToggle}
            aria-label="Toggle menu"
          >
            <div className={styles.burgerLine}></div>
            <div className={styles.burgerLine}></div>
            <div className={styles.burgerLineX}></div>
            <div className={styles.burgerLineX}></div>
          </button>
        </div>
      </div>
    </header>
  )
}
